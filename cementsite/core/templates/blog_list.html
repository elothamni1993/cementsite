{% extends "base.html" %}
{% block title %}Blog – Free Articles{% endblock %}

{% block extra_css %}
<style>
  .blog-hero {
    display:flex; align-items:center; justify-content:space-between; gap:1rem;
    margin:.5rem 0 1rem;
  }
  .blog-hero h1 { margin:0; }
  .search-wrap {
    margin-left:auto; display:flex; align-items:center; gap:.5rem;
  }
  .search-wrap input[type="search"]{
    padding:.55rem .7rem; border:1px solid #e5e7eb; border-radius:10px; width:220px;
  }
  /* AdSense wrapper to add some spacing */
  .ads-wrap { margin: .5rem 0 1rem; }

  /* Card grid */
  .cards {
    display:grid; gap:14px;
    grid-template-columns: repeat(1, minmax(0,1fr));
  }
  @media (min-width:640px){ .cards { grid-template-columns: repeat(2, minmax(0,1fr)); } }
  @media (min-width:980px){ .cards { grid-template-columns: repeat(3, minmax(0,1fr)); } }

  .card {
    background:#fff; border:1px solid #e5e7eb; border-radius:14px; padding:14px;
    box-shadow: 0 10px 30px rgba(31,41,55,.04);
    display:flex; flex-direction:column; gap:.5rem;
  }
  .card h3 { margin:.1rem 0 .25rem; font-size:1.05rem; }
  .card a { text-decoration:none; color:#111827; }
  .card a:hover { text-decoration:underline; }
  .meta { font-size:.85rem; color:#6b7280; }
  .teaser { color:#374151; font-size:.95rem; }
  .empty { text-align:center; padding:2rem; border:1px dashed #e5e7eb; border-radius:12px; background:#fafafa; color:#6b7280; }
</style>
{% endblock %}

{% block content %}
<div class="blog-hero">
  <h1>Free Articles</h1>
  <div class="search-wrap">
    <input id="searchInput" type="search" placeholder="Search titles…" aria-label="Search titles">
  </div>
</div>

{% if ADSENSE_CLIENT %}
<div class="ads-wrap">
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="{{ ADSENSE_CLIENT }}"
       data-ad-slot="1234567890"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
</div>
{% endif %}

{% comment %}
We render as cards. If your view later sends `page_obj`, you can switch the for-loop
to page_obj.object_list without changing this template’s structure.
{% endcomment %}
{% if articles %}
  <div id="cards" class="cards">
    {% for a in articles %}
      <article class="card" data-title="{{ a.title|lower }}">
        <h3><a href="{% url 'article_detail' a.slug %}">{{ a.title }}</a></h3>
        <div class="meta">{{ a.created_at|date:"Y-m-d" }} · Free</div>
        {% if a.excerpt %}
          <p class="teaser">{{ a.excerpt }}</p>
        {% endif %}
        <div>
          <a href="{% url 'article_detail' a.slug %}" class="meta">Read →</a>
        </div>
      </article>
    {% endfor %}
  </div>
{% else %}
  <div class="empty">No articles.</div>
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
  // Client-side title filter (no backend changes required)
  (function(){
    var input = document.getElementById('searchInput');
    var cards = document.querySelectorAll('#cards .card');
    if (!input || !cards.length) return;

    var fn = function(){
      var q = (input.value || '').toLowerCase().trim();
      var shown = 0;
      cards.forEach(function(card){
        var t = card.getAttribute('data-title') || '';
        var match = !q || t.indexOf(q) !== -1;
        card.style.display = match ? '' : 'none';
        if (match) shown++;
      });
    };
    input.addEventListener('input', fn);
  })();
</script>
{% endblock %}
